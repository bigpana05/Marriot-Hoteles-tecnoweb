<nav class="navbar-marriott">
  <div class="container-1440 navbar-inner">
    <!-- Izquierda: logo + divisor -->
    <div class="navbar-left">
      <a class="brand" routerLink="/client/home" aria-label="Marriott International">
        <img src="assets/brand/marriott-international-logo.svg" alt="Marriott International">
      </a>
      <span class="v-divider desktop-md" aria-hidden="true"></span>
    </div>

    <!-- Centro: links (solo desktop / laptop) -->
    <div class="navbar-center desktop-md">
      <ul class="nav-links">
        <li><a routerLink="/client/catalog" routerLinkActive="active">Hotels</a></li>
        <li><a routerLink="/client/experiences" routerLinkActive="active">Experiences</a></li>
        <li><a routerLink="/client/offers" routerLinkActive="active">Exclusive Offers</a></li>
        <li><a routerLink="/about" routerLinkActive="active">About Us</a></li>
      </ul>
    </div>

    <!-- Derecha: idioma, reserva, usuario, login y menú hamburguesa -->
    <div class="navbar-right">
      <!-- Selector de idioma (desktop) -->
      <div class="lang-selector desktop-md">
        <button 
          type="button" 
          class="lang-button"
          (click)="toggleLangMenu()"
          [class.active]="isLangMenuOpen">
          <img class="icon-20" src="assets/icons/globe.svg" alt="">
          <span class="lang-text">EN</span>
        </button>
        
        <div class="lang-menu" *ngIf="isLangMenuOpen">
          <div class="lang-menu-title">Language</div>
          <div class="lang-option" (click)="selectLanguage('en')">
            <span class="lang-name">English</span>
            <span class="lang-checkmark" *ngIf="currentLang === 'en'">✓</span>
          </div>
          <div class="lang-option lang-option-disabled" (click)="$event.preventDefault()">
            <span class="lang-name">Español</span>
            <span class="lang-checkmark"></span>
          </div>
        </div>
      </div>

      <!-- Selector de idioma mobile -->
      <div class="lang-selector mobile-lang-button mobile-only">
        <button 
          type="button" 
          class="lang-button"
          (click)="toggleLangMenu()"
          [class.active]="isLangMenuOpen">
          <img class="icon-20" src="assets/icons/globe.svg" alt="">
          <span class="lang-text">EN</span>
        </button>
        
        <div class="lang-menu" *ngIf="isLangMenuOpen">
          <div class="lang-menu-title">Language</div>
          <div class="lang-option" (click)="selectLanguage('en')">
            <span class="lang-name">English</span>
            <span class="lang-checkmark" *ngIf="currentLang === 'en'">✓</span>
          </div>
          <div class="lang-option lang-option-disabled" (click)="$event.preventDefault()">
            <span class="lang-name">Español</span>
            <span class="lang-checkmark"></span>
          </div>
        </div>
      </div>

      <button type="button" class="btn-reserve desktop-md">Reserve</button>

      <!-- Zona derecha: usuario (desktop) -->
      <div class="user-actions desktop-md">
        <ng-container *ngIf="user; else guestDesktop">
          <!-- Dropdown usuario -->
          <div class="user-dropdown">
            <button
              type="button"
              class="user-dropdown-trigger"
              (click)="toggleUserDropdown()"
              [class.active]="isUserDropdownOpen"
            >
              <img class="icon-20" src="assets/icons/user.svg" alt="">
              <span>{{ user.name }}</span>
              <span class="dropdown-arrow">▼</span>
            </button>

            <!-- Menú desplegable -->
            <div class="user-dropdown-menu" *ngIf="isUserDropdownOpen">
              <div class="dropdown-header">
                <p class="welcome-message">Welcome back, {{ user.name }}!</p>
                <small *ngIf="user.role === 'ADMIN'" class="admin-badge">Administrator</small>
                <small *ngIf="user.role === 'CLIENT'" class="client-badge">Guest</small>
              </div>

              <div class="dropdown-divider"></div>

              <!-- Opciones según rol -->
              <a
                *ngIf="user.role === 'CLIENT'"
                routerLink="/client/profile"
                class="dropdown-item"
                (click)="toggleUserDropdown()"
              >
                <span>My Profile</span>
              </a>

              <a
                *ngIf="user.role === 'CLIENT'"
                routerLink="/client/cart"
                class="dropdown-item"
                (click)="toggleUserDropdown()"
              >
                <span>My Cart</span>
              </a>

              <a
                *ngIf="user.role === 'ADMIN'"
                routerLink="/admin/dashboard"
                class="dropdown-item"
                (click)="toggleUserDropdown()"
              >
                <span>Admin Panel</span>
              </a>

              <a
                *ngIf="user.role === 'ADMIN'"
                routerLink="/admin/users"
                class="dropdown-item"
                (click)="toggleUserDropdown()"
              >
                <span>Users</span>
              </a>

              <div class="dropdown-divider"></div>

              <!-- Logout -->
              <button
                type="button"
                class="dropdown-item logout-item"
                (click)="logout()"
              >
                <span>Sign out</span>
              </button>
            </div>
          </div>
        </ng-container>

        <ng-template #guestDesktop>
          <a class="signin" routerLink="/client/login">
            <img class="icon-20" src="assets/icons/user.svg" alt="">
            <span>Sign in or join</span>
          </a>
        </ng-template>
      </div>

      <!-- visible en tablet/móvil: botón menú -->
      <button
        type="button"
        class="btn-menu mobile-only"
        (click)="toggleMenu()"
        [attr.aria-expanded]="isMenuOpen"
        aria-label="Open navigation menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>

  <!-- Menú desplegable para tablet/móvil -->
  <div class="mobile-menu mobile-only" *ngIf="isMenuOpen">
    <!-- Header del menú con logo y botón cerrar -->
    <div class="mobile-menu-header">
      <a class="mobile-menu-logo" routerLink="/client/home" (click)="closeMenu()">
        <img src="assets/brand/marriott-international-logo.svg" alt="Marriott International">
      </a>
      <button type="button" class="btn-close-menu" (click)="closeMenu()" aria-label="Close menu">
        ✕
      </button>
    </div>

    <ul class="mobile-nav-links">
      <li><a routerLink="/client/catalog" (click)="closeMenu()">Hotels</a></li>
      <li><a routerLink="/client/experiences" (click)="closeMenu()">Experiences</a></li>
      <li><a routerLink="/client/offers" (click)="closeMenu()">Exclusive Offers</a></li>
      <li><a routerLink="/about" (click)="closeMenu()">About Us</a></li>
    </ul>

    <div class="mobile-actions">
      <!-- Usuario en mobile -->
      <ng-container *ngIf="user; else guestMobile">
        <div class="mobile-user-info">
          <span>
            Hello, <strong>{{ user.name }}</strong>
            <span *ngIf="user.role === 'ADMIN'">(Administrator)</span>
          </span>
        </div>

        <a
          *ngIf="user.role === 'CLIENT'"
          class="mobile-signin"
          routerLink="/client/profile"
          (click)="closeMenu()"
        >
          <img class="icon-20" src="assets/icons/user.svg" alt="">
          <span>My Profile</span>
        </a>

        <a
          *ngIf="user.role === 'ADMIN'"
          class="mobile-signin"
          routerLink="/admin/dashboard"
          (click)="closeMenu()"
        >
          <img class="icon-20" src="assets/icons/user.svg" alt="">
          <span>Admin Panel</span>
        </a>
      </ng-container>

      <ng-template #guestMobile>
        <a class="mobile-signin" routerLink="/client/login" (click)="closeMenu()">
          <img class="icon-20" src="assets/icons/user.svg" alt="">
          <span>Sign in or join</span>
        </a>
      </ng-template>

      <button type="button" class="mobile-reserve" (click)="closeMenu()">Reserve</button>
    </div>
  </div>
</nav>
